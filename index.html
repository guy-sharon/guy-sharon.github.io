<!DOCTYPE html>
<html>
<head>
  <title>מדריך טיולים</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Verdana, Geneva, Tahoma, sans-serif; text-align: center; 
        background: #f0f4f8; }
    button { 
      background: #0b72b9; color:  rgb(255, 255, 255); font-size: 3em; 
      padding: 10px 20px; margin: 12px 23px; border: none; border-radius: 15px;
      width: 75%;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
    }
    h1 { color: #2a2344; font-size : 2.5em; margin-top: 30px; }
    h2 { font-size : 1.9em; }
  </style>

  <script>
        async function registerServiceWorker() {
            if ("serviceWorker" in navigator) {
            try {
                const registration = await navigator.serviceWorker.register(
                    "sw.js"
                );
                console.log(
                "Service Worker registered with scope:",
                registration.scope
                );
            } catch (error) {
                console.error("Service Worker registration failed:", error);
            }
            }
        }

        registerServiceWorker();
  </script>

  <script>
        // Function to check user's location
        function open_navigation(destLat, destLng, waze) {
            if (waze) {
                window.location.href = `https://waze.com/ul?ll=${destLat},${destLng}&navigate=yes`;
            }
            else {
                window.location.href = `https://www.google.com/maps/dir/?api=1&destination=${destLat},${destLng}&travelmode=walking`;
            }
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radius of the Earth in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c; // Distance in km
            return distance;
        }

        function checkLocation(destLat, destLng, placeName, verified_locations, verify_dists_km, waze) {
            if (!navigator.geolocation) {
                alert('Geolocation is not supported by your browser.');
                return;
            }
            navigator.geolocation.getCurrentPosition((position) => {
                const userLat = position.coords.latitude;
                const userLng = position.coords.longitude;
                
                // check distance to destination
                const distance = calculateDistance(userLat, userLng, destLat, destLng);
                if (distance <= 20e3) { // within 20km
                    open_navigation(destLat, destLng, false);
                    return;
                }
                
                // Calculate distance in km using Haversine formula
                const R = 6371; // Earth radius in km
                all_locs = verified_locations.slice();
                // all_locs.push([destLat, destLng]);
                for (let i = 0; i < all_locs.length; i++) {
                    const vLat = all_locs[i][0];
                    const vLng = all_locs[i][1];
                    const distance = calculateDistance(userLat, userLng, vLat, vLng);
                    if (distanceV <= verify_dists_km[i]) {
                        // User is within a verified location
                        open_navigation(destLat, destLng, waze);
                        return;
                    }
                }

                var msg = "האם אתם בטוחים שברצונכם להגיע ל"
                msg += `${placeName}`
                msg += "?"
                const proceed = confirm(msg);
                if (proceed) {
                    open_navigation(destLat, destLng, waze);
                }

            }, () => {
                open_navigation(destLat, destLng, waze);
            },
            {
                maximumAge: 60000,  // use cached location up to 60s
                timeout: 500
            });
        }
    </script>
</head>
<body>
  <h1>מדריך טיולים גרסת פיתוח</h1>
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">3/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(31.77887959177701, 35.20774504578961, 'מלון קווליטי אולאבסגארד', [[31.97101999898877, 35.21315829125738], [31.94883536145229, 35.21952748864361], [31.90924814673672, 35.21805767386217], [31.875873803966556, 35.215118044299295], [31.848453694331322, 35.20768731401536]], [1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333], 1)">1
        <div style="font-size: 0.4em; margin-top: 0.3em;">מלון קווליטי אולאבסגארד</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">4/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(31.971300393037957, 34.77591912416341, 'כנסיית העץ העתיקה', [[31.78550122900793, 35.179614987592096], [31.737255752741603, 35.14885327082277], [31.686974282025677, 35.12468334882398], [31.686974281837543, 35.09392163267362], [31.617174779810988, 35.06865307791184], [31.5646885135516, 35.042835209194905]], [3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.6666666666666665], 1)">2
        <div style="font-size: 0.4em; margin-top: 0.3em;">כנסיית העץ העתיקה</div>
        </button>
    
      <button onclick="checkLocation(31.53975042344299, 35.02983385976519, 'נוטודן', [[31.78550122900793, 35.179614987592096]], [3.3333333333333335], 1)">3
        <div style="font-size: 0.4em; margin-top: 0.3em;">נוטודן</div>
        </button>
    
      <button onclick="checkLocation(31.686928448949352, 34.84260449217907, 'מלון ווגסלידטון', [[31.571400281425998, 35.00398435691253], [31.569666927631427, 34.97511062576993], [31.51326337493168, 34.951620132636954], [31.552326364921036, 34.92641679104637], [31.601713307161774, 34.90537322428142], [31.64408590543616, 34.8884894323421], [31.679481743581267, 34.86353078338831]], [3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335, 3.3333333333333335], 1)">4
        <div style="font-size: 0.4em; margin-top: 0.3em;">מלון ווגסלידטון</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">5/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(31.812069766353012, 34.76206564280352, 'מפלי לטפוסן', [[31.68581291342051, 34.84265109972958], [31.699638851982378, 34.83349525250587], [31.72266390633724, 34.82401241073845], [31.74145085522261, 34.81245860352757], [31.74145085522261, 34.800468803591755], [31.741067599435095, 34.79022297455569], [31.72228034155097, 34.78150312005692], [31.742217347884576, 34.77452723645789], [31.771325388290773, 34.76864133467122], [31.795426840237216, 34.762755432884546]], [1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333], 1)">5
        <div style="font-size: 0.4em; margin-top: 0.3em;">מפלי לטפוסן</div>
        </button>
    
      <button onclick="checkLocation(32.07573428506016, 34.769544841798016, 'בית הקפה והמאפייה פלוי', [[31.68581291342051, 34.84265109972958], [31.699638851982378, 34.83349525250587], [31.72266390633724, 34.82401241073845], [31.74145085522261, 34.81245860352757], [31.74145085522261, 34.800468803591755], [31.741067599435095, 34.79022297455569], [31.72228034155097, 34.78150312005692], [31.742217347884576, 34.77452723645789], [31.771325388290773, 34.76864133467122], [31.795426840237216, 34.762755432884546], [31.81529225196482, 34.761943090990286], [31.846607462175538, 34.75993918443093], [31.879496799366713, 34.760247477747754], [31.912339404689472, 34.75886015782204], [31.944598060728683, 34.760401624406164], [31.97037249212188, 34.76271382428234], [32.00040618833273, 34.764255290866465], [32.02397655809651, 34.76502602415853], [32.046452960980986, 34.76533431747535], [32.06356304103624, 34.76810895732677]], [1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333], 1)">6
        <div style="font-size: 0.4em; margin-top: 0.3em;">בית הקפה והמאפייה פלוי</div>
        </button>
    
      <button onclick="checkLocation(32.175128687836065, 34.810722808653864, 'איידפיורד', [[31.687821864774424, 34.8424719303696], [31.740998956058636, 34.80786499833563], [31.766095053753105, 34.76941285163122], [31.849873936742647, 34.76007447314586], [31.97258591972536, 34.76144776409959], [32.08132769671778, 34.767764902486746], [32.178186273499065, 34.797977303468784]], [4.333333333333333, 4.333333333333333, 4.333333333333333, 4.333333333333333, 4.333333333333333, 4.333333333333333, 4.333333333333333], 1)">7
        <div style="font-size: 0.4em; margin-top: 0.3em;">איידפיורד</div>
        </button>
    
      <button onclick="checkLocation(32.10747182182504, 34.71450240229853, 'מפלי שטיינסדלספוסן', [[32.175274439109636, 34.81086747038578], [32.18301540973146, 34.79919949548775], [32.19307472855441, 34.785736447528485], [32.2100880405285, 34.774292856763104], [32.17682284426406, 34.76441995492631], [32.1574601940104, 34.75028375456908], [32.13653000199703, 34.74018646859963], [32.11713302723893, 34.7285184937016], [32.10936961315628, 34.71752367120153]], [2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0], 1)">8
        <div style="font-size: 0.4em; margin-top: 0.3em;">מפלי שטיינסדלספוסן</div>
        </button>
    
      <button onclick="checkLocation(32.12212714607635, 34.635864441825014, 'ברגן', [[32.17341058020356, 34.81075006074048], [32.17728171276589, 34.79504317145467], [32.199721278884134, 34.7840483489546], [32.224456450805214, 34.776643672577], [32.251479659412624, 34.767443923138174], [32.289257988875505, 34.75375649104625], [32.28771725240681, 34.734908223903275], [32.3000401998492, 34.71516242022969], [32.2900283176732, 34.69766045788264], [32.26382238568394, 34.685319330586644], [32.22600150320265, 34.67656834941312], [32.18037814397898, 34.67724150181108], [32.1563697602494, 34.668041752372254], [32.19817443454201, 34.771034069260644], [32.16798988652709, 34.75959047849527], [32.15094500227924, 34.74567866227069], [32.121473738459834, 34.73109369364815], [32.108347615668734, 34.71364349298331], [32.121141953346665, 34.700195639812705], [32.11358253062137, 34.68237723436166], [32.12695518844287, 34.66842508669716], [32.14322435941459, 34.65598582251435], [32.16064272068043, 34.63598214092308], [32.06525940483531, 34.65564962618509], [32.01153634844792, 34.6491281537156], [32.06467657490907, 34.63631833725235], [32.127536430398195, 34.643210362002286]], [2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335], 1)">9
        <div style="font-size: 0.4em; margin-top: 0.3em;">ברגן</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">6/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(32.128237470672985, 34.634227369464845, 'האקווריום הלאומי בברגן', [[32.12505467828362, 34.636182773445604]], [1.0], 1)">10
        <div style="font-size: 0.4em; margin-top: 0.3em;">האקווריום הלאומי בברגן</div>
        </button>
    
      <button onclick="checkLocation(32.128237470672985, 34.634227369464845, 'מלון רדיסון בלו רויאל', [[32.12505467828362, 34.636182773445604]], [1.0], 1)">11
        <div style="font-size: 0.4em; margin-top: 0.3em;">מלון רדיסון בלו רויאל</div>
        </button>
    
      <button onclick="checkLocation(32.126762280192395, 34.635795634189535, 'נקודת מפגש לשייט במפרץ מוסטראומן', [], [], 0)">12
        <div style="font-size: 0.4em; margin-top: 0.3em;">נקודת מפגש לשייט במפרץ מוסטראומן</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">7/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(32.12659479277955, 34.636154411906304, 'מדרחוב בריגן', [], [], 0)">13
        <div style="font-size: 0.4em; margin-top: 0.3em;">מדרחוב בריגן</div>
        </button>
    
      <button onclick="checkLocation(32.12462592477799, 34.63621815793824, 'שוק הדגים בברגן', [], [], 0)">14
        <div style="font-size: 0.4em; margin-top: 0.3em;">שוק הדגים בברגן</div>
        </button>
    
      <button onclick="checkLocation(32.12574848296595, 34.63654034780949, 'רכבל פלויבנן', [], [], 0)">15
        <div style="font-size: 0.4em; margin-top: 0.3em;">רכבל פלויבנן</div>
        </button>
    
      <button onclick="checkLocation(32.12635103606617, 34.63604101997679, 'מסעדת יוניקורן פיש', [], [], 0)">16
        <div style="font-size: 0.4em; margin-top: 0.3em;">מסעדת יוניקורן פיש</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">8/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(32.46340148836098, 34.78797831303098, 'עמק הוויקינגים', [[32.12876599611286, 34.63607631793324], [32.171824095691825, 34.6362596302854], [32.16549713138712, 34.64799162082399], [32.14777226043204, 34.659906923714736], [32.16739540559446, 34.67713828481828], [32.22048276388158, 34.67658834776178], [32.27155664111209, 34.68593727772222], [32.29421915762511, 34.69950239178245], [32.30113927949033, 34.71856687640765], [32.28666751262384, 34.73708142397635], [32.32754204395376, 34.749363351571425], [32.36896964675563, 34.75302959861474], [32.40092965532212, 34.75981215564485], [32.41345057343642, 34.76824452384446], [32.44347225340645, 34.78015982673521]], [2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335, 2.3333333333333335], 1)">17
        <div style="font-size: 0.4em; margin-top: 0.3em;">עמק הוויקינגים</div>
        </button>
    
      <button onclick="checkLocation(32.4516983916878, 34.814935878029566, 'פלם', [[32.4724433550059, 34.80756712077536], [32.465944300557226, 34.79339647101161]], [2.3333333333333335, 2.3333333333333335], 1)">18
        <div style="font-size: 0.4em; margin-top: 0.3em;">פלם</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">9/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(32.514358344526826, 34.814157653619915, 'אונדרדל', [[32.46317417485102, 34.81422315292469]], [2.3333333333333335], 1)">19
        <div style="font-size: 0.4em; margin-top: 0.3em;">אונדרדל</div>
        </button>
    
      <button onclick="checkLocation(32.45241784616591, 34.81515901147437, 'רכבת פלם', [], [], 0)">20
        <div style="font-size: 0.4em; margin-top: 0.3em;">רכבת פלם</div>
        </button>
    
      <button onclick="checkLocation(32.45231372267575, 34.81515712595008, 'שייט במפרץ נארוי', [], [], 0)">21
        <div style="font-size: 0.4em; margin-top: 0.3em;">שייט במפרץ נארוי</div>
        </button>
    
    
            <div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
                <h2 style="margin: 0; padding: 0 1em; width: fit-content;">10/08</h2>
                <div style="flex: 1; border-bottom: 1px solid #000; border-top: 1px solid #000;"></div>
            </div>
                  <button onclick="checkLocation(32.452635828343, 34.81516823014306, 'תחנת אוטובוס C תצפית סטגסטין', [], [], 0)">22
        <div style="font-size: 0.4em; margin-top: 0.3em;">תחנת אוטובוס C תצפית סטגסטין</div>
        </button>
    
      <button onclick="checkLocation(32.58236439674902, 34.88512603660966, 'כנסיית העץ בורגונד', [[32.4648068857277, 34.81880682528967], [32.47836892552932, 34.82224005267399], [32.491922730764664, 34.82910650726933], [32.504534391928715, 34.83350103832126], [32.521805455934754, 34.83830755665931], [32.53999560014537, 34.844762024141836], [32.55863671791757, 34.84860723881228], [32.579123898821706, 34.8520404661966], [32.5865690970985, 34.85616033905779], [32.583777440523534, 34.86247747744494], [32.583777440523534, 34.86906927402284], [32.584242741016304, 34.87456243783775], [32.584242741016304, 34.88060491803416]], [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334], 1)">23
        <div style="font-size: 0.4em; margin-top: 0.3em;">כנסיית העץ בורגונד</div>
        </button>
    
      <button onclick="checkLocation(31.96617325355685, 35.12926385222993, 'הונפוס', [[32.58239452749357, 34.88515721451873], [32.61355037391563, 34.92507876365417], [32.603101867811795, 34.966534957091724], [32.51933624660516, 34.94448379036962], [32.553778209904365, 34.995642497164894], [32.46832429867, 34.97800156378722], [32.47583337456242, 35.02210389723142], [32.382542204525315, 35.00137580051265], [32.40514830679639, 35.0481242739635], [32.29037579555246, 35.02430901390363], [32.27220024803494, 35.07370362736114], [32.16740663295585, 35.047683250629056], [32.15827123058676, 35.0953137707488], [32.06212769229423, 35.078113860705564], [32.033052416677606, 35.10766242411318]], [5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333, 5.333333333333333], 1)">24
        <div style="font-size: 0.4em; margin-top: 0.3em;">הונפוס</div>
        </button>
    

  <script>
    function openLink(url) { window.location.href = url; }
  </script>
</body>
</html>
